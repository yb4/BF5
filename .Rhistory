names(drunk_people_per_state) <- c("region", "average")
states <- map_data("state")
graph <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "#ffffff", color = "#ffffff", size = 0.15)
graph <- graph + geom_map(data = drunk_people_per_state, map = states, aes(fill = average, map_id = region))
grpah
graph
View(drunk_people_per_state)
View(drunk_people_per_state)
drunk_people_per_state <- drunk_people_total_by_state %>% select(state, both_sexes_2012) %>% group_by(state) %>% summarise(average = mean(both_sexes_2012)) %>% filter(state != "National") %>% mutate(state = toLower(state))
drunk_people_per_state <- drunk_people_total_by_state %>% select(state, both_sexes_2012) %>% group_by(state) %>% summarise(average = mean(both_sexes_2012)) %>% filter(state != "National") %>% mutate(state = tolower(state))
drunk_people_total_by_state <- data.table :: fread ("data/binge_drinking.csv", sep = ",", stringsAsFactors = FALSE)
drunk_people_per_state <- drunk_people_total_by_state %>% select(state, both_sexes_2012) %>% group_by(state) %>% summarise(average = mean(both_sexes_2012)) %>% filter(state != "National") %>% mutate(state = tolower(state))
names(drunk_people_per_state) <- c("region", "average")
states <- map_data("state")
graph <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "#ffffff", color = "#ffffff", size = 0.15)
graph <- graph + geom_map(data = drunk_people_per_state, map = states, aes(fill = average, map_id = region))
graph
graph <- graph + geom_map(data = drunk_people_per_state, map = states, aes(fill = average, map_id = region) +scale_fill_continuous(color = "red")
graph <- graph + geom_map(data = drunk_people_per_state, map = states, aes(fill = average, map_id = region) +scale_fill_continuous(low = 'green', high = 'red', guide = 'colorbar')
homeless_people_per_state <- homeless_by_state %.% select(State, Count) %>% group_by(state) %>% summarize(sum = sum(Count)) %>% filter(state != "Guam") %>% mutate(State = tolower(State))
homeless_people_per_state <- homeless_by_state %>% select(State, Count) %>% group_by(state) %>% summarize(sum = sum(Count)) %>% filter(state != "Guam") %>% mutate(State = tolower(State))
homeless_people_per_state <- homeless_by_state %>% select(State, Count) %>% group_by(state) %>% summarize(sum = sum(Count)) %>% filter(state != "Guam") %>% mutate(State = tolower(State))
homeless_people_per_state <- homeless_by_state %>% select(State, Count) %>% group_by(State) %>% summarize(sum = sum(Count)) %>% filter(state != "Guam") %>% mutate(State = tolower(State))
homeless_people_per_state <- homeless_by_state %>% select(State, Count) %>% group_by(State) %>% summarize(sum = sum(Count)) %>% filter(state != "Guam") %>% mutate(State = tolower(State))
homeless_people_per_state <- homeless_by_state %>% select(State, Count) %>% group_by(State) %>% summarize(sum = sum(Count))%>% filter(state != "Guam") %>% mutate(State = tolower(State))
homeless_people_per_state <- homeless_by_state %>% select(State, Count) %>% group_by(State) %>% summarize(sum = colSums(Count))%>% filter(state != "Guam") %>% mutate(State = tolower(State))
homeless_people_per_state <- homeless_by_state %>% select(State, Count) %>% group_by(State) %>% filter(state != "Guam") %>% mutate(State = tolower(State))
homeless_people_per_state <- homeless_by_state %>% select(State, Count) %>% group_by(State) %>% filter(State != "Guam") %>% mutate(State = tolower(State))
View(homeless_by_state)
View(homeless_by_state)
homeless_people_per_state <- homeless_by_state %>% mutate(State = tolower(State))%>% select(State, Count) %>% group_by(State) %>% filter(State != "Guam") %>% mutate(State = tolower(State))
data_sets %>% ggvis(~Year, ~Count) %>% layer_points(fill = ~temp_name) #%>% data_sets_drunk %>% ggvis(~location, ~both_sexes_2012) %>% layer_lines()
library(ggvis)
data_sets %>% ggvis(~Year, ~Count) %>% layer_points(fill = ~temp_name) #%>% data_sets_drunk %>% ggvis(~location, ~both_sexes_2012) %>% layer_lines()
drunk_people_per_state <- drunk_people_total_by_state %>% select(state, both_sexes_2012) %>% group_by(state) %>% summarise(average = mean(both_sexes_2012)) %>% filter(state != "National")
View(drunk_people_per_state)
homeless_people_per_state <- homeless_by_state %>% group_by(State) %>% select(State, Count) %>% group_by(State) %>% filter(State != "Guam")
View(homeless_people_per_state)
View(homeless_people_per_state)
homeless_people_per_state <- homeless_by_state %>% group_by(State) %>% select(State, Count) %>% group_by(State) %>% filter(State != "Guam") %>% summarise(sum = sum(Count))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% group_by(State) %>% filter(State != "Guam") %>% summarise(sum = sum(Count))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% group_by(State) %>% filter(State != "Guam")
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% group_by(State) %>% summarize(sum  =sum(Count)) %>% filter(State != "Guam")
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% group_by(State) %>% summarise(total=sum(Count)) %>% filter(State != "Guam")
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% group_by(State) %>% summarise(total=sum(Count)) %>% filter(State != "Guam")
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% group_by(State) %>% summarise(total=sum(Count)) %>% filter(State != "Guam")
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% group_by(State) %>% summarise( "total" =sum(Count)) %>% filter(State != "Guam")
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% group_by(State) %>% summarise( "total" = sum("Count")) %>% filter(State != "Guam")
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% group_by(State) %>% summarise( "total" = mean("Count")) %>% filter(State != "Guam")
warrnings()
warnings()
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% group_by(State)  %>% filter(State != "Guam") %>% summarise( "total" = mean("Count"))
shiny::runApp()
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% group_by(State)  %>% filter(State != "Guam") %>% summarise( "total" = mean(Count))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% group_by(State)  %>% filter(State != "Guam") %>% summarise( "Count" = sum(Count))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% group_by(State)  %>% filter(State != "Guam") %>% summarise( "Count" = sum(Count))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% group_by(State)  %>% filter(State != "Guam") %>% summarise( "Count" = sum(Count))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% group_by(State)  %>% filter(State != "Guam")
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% filter(State != "Guam") %>% group_by(State) %>% summarise(Count = sum(Count))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% filter(State != "Guam") %>% group_by(State) %>% summarise(Count = sum(Count))
View(homeless_people_per_state)
View(homeless_people_per_state)
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% filter(State != "Guam") %>% group_by(State) %>% summarise(Count = sum(as.numeric(Count)))
warnings()
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% filter(State != "Guam" && Count != NA) %>% group_by(State) %>% summarise(Count = sum((Count)))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% filter(State != "Guam" && Count != "NA") %>% group_by(State) %>% summarise(Count = sum((Count)))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% filter(State != "Guam" && Count != "NA") %>% group_by(State) %>% summarise(Count = sum(Count))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% filter(State != "Guam") %>% filter(Count != "NA") %>% group_by(State) %>% summarise(Count = sum(Count))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% filter(State != "Guam") %>% filter(Count != "0") %>% group_by(State) %>% summarise(Count = sum(Count))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% filter(State != "Guam") %>% filter(Count != "0") %>% group_by(State) %>% summarise(Count = sum(as.numeric(Count)))
warnings()
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% filter(State != "Guam") %>% filter(Count != "NA") %>% as.numeric(gsub(",","",,fixed=TRUE)) %>% group_by(State) %>% summarise(Count = sum(as.numeric(Count)))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% filter(State != "Guam") %>% filter(Count != "NA") %>% as.numeric(gsub(",","",x,fixed=TRUE)) %>% group_by(State) %>% summarise(Count = sum(as.numeric(Count)))
homeless_by_state$Count <- as.numeric(gsub(",","",homeless_by_state$Count))
homeless_by_state$Count <- as.numeric(gsub(",","",homeless_by_state$Count))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% filter(State != "Guam") %>% filter(Count != "NA") %>%  group_by(State) %>% summarise(Count = sum(as.numeric(Count)))
drunk_people_total_by_state <- data.table :: fread ("data/binge_drinking.csv", sep = ",", stringsAsFactors = FALSE)
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>% select(State, Count) %>% filter(State != "GU" & State != "PR") %>% filter(Count != "NA") %>%  group_by(State) %>% summarise(Count = sum(as.numeric(Count)))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>%
select(State, Count) %>% filter(State != "GU" & State != "PR") %>%
filter(Count != "NA") %>%  group_by(State) %>%
summarise(Count = sum(as.numeric(Count)))
homeless_by_state$Count <- as.numeric(gsub(",","",homeless_by_state$Count))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>%
select(State, Count) %>% filter(State != "GU" & State != "PR" & State != "VI") %>%
filter(Count != "NA") %>%  group_by(State) %>%
summarise(Count = sum(as.numeric(Count)))
homeless_by_state$Count <- as.numeric(gsub(",","",homeless_by_state$Count))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>%
select(State, Count) %>% filter(State != "GU" & State != "PR" & State != "VI") %>%
filter(Count != "NA") %>%  group_by(State) %>%
summarise(Count = sum(as.numeric(Count))) %>% mutate(State = tolower(State))
names(homeless_by_state) <- c("region", "average")
states <- map_data("state")
graph <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "#ffffff", color = "#ffffff", size = 0.15)
graph <- graph + geom_map(data = homeless_by_state, map = states, aes(fill = average, map_id = region))
drunk_people_total_by_state <- data.table :: fread ("data/binge_drinking.csv", sep = ",", stringsAsFactors = FALSE)
drunk_people_per_state <- drunk_people_total_by_state %>% select(state, both_sexes_2012) %>%
group_by(state) %>% summarise(average = mean(both_sexes_2012)) %>%
filter(state != "National") %>% mutate(state = tolower(state))
names(drunk_people_per_state) <- c("region", "average")
states <- map_data("state")
graph <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "#ffffff", color = "#ffffff", size = 0.15)
graph <- graph + geom_map(data = drunk_people_per_state, map = states, aes(fill = average, map_id = region))
graph
homeless_by_state$Count <- as.numeric(gsub(",","",homeless_by_state$Count))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>%
select(State, Count) %>% filter(State != "GU" & State != "PR" & State != "VI") %>%
filter(Count != "NA") %>%  group_by(State) %>%
summarise(Count = sum(as.numeric(Count))) %>% mutate(State = tolower(State))
names(homeless_by_state) <- c("region", "average")
states <- map_data("state")
graph <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "#ffffff", color = "#ffffff", size = 0.15)
graph <- graph + geom_map(data = homeless_by_state, map = states, aes(fill = average, map_id = region))
homeless_by_state$Count <- as.numeric(gsub(",","",homeless_by_state$Count))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>%
select(State, Count) %>% filter(State != "GU" & State != "PR" & State != "VI") %>%
filter(Count != "NA") %>%  group_by(State) %>%
summarise(Count = sum(as.numeric(Count))) %>% mutate(State = tolower(State))
names(homeless_by_state) <- c("region", "average")
states <- map_data("state")
graph <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "#ffffff", color = "#ffffff", size = 0.15)
graph <- graph + geom_map(data = homeless_by_state, map = states, aes(fill = average, map_id = region))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>%
select(State, Count) %>% filter(State != "GU" & State != "PR" & State != "VI") %>%
filter(Count != "NA") %>%  group_by(State) %>%
summarise(Count = sum(as.numeric(Count))) %>% mutate(State = tolower(State))
names(homeless_people_per_state) <- c("region", "average")
states <- map_data("state")
graph <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "#ffffff", color = "#ffffff", size = 0.15)
graph <- graph + geom_map(data = homeless_people_per_state, map = states, aes(fill = average, map_id = region))
homeless_by_state$Count <- as.numeric(gsub(",","",homeless_by_state$Count))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>%
select(State, Count) %>% filter(State != "GU" & State != "PR" & State != "VI") %>%
filter(Count != "NA") %>%  group_by(State) %>%
summarise(Count = sum(as.numeric(Count))) %>% mutate(State = tolower(State))
names(homeless_people_per_state) <- c("region", "average")
states <- map_data("state")
graph <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "#ffffff", color = "#ffffff", size = 0.15)
graph <- graph + geom_map(data = homeless_people_per_state, map = states, aes(fill = average, map_id = region))
graph
homeless_by_state$Count <- as.numeric(gsub(",","",homeless_by_state$Count))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>%
select(State, Count) %>% filter(State != "GU" & State != "PR" & State != "VI") %>%
filter(Count != "NA") %>%  group_by(State) %>%
summarise(Count = sum(as.numeric(Count))) %>% mutate(State = tolower(State))
names(homeless_people_per_state) <- c("region", "average")
states <- map_data("state")
graph <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "#ffffff", color = "#ffffff", size = 0.15)
graph <- graph + geom_map(data = homeless_people_per_state, map = states, aes(fill = average, map_id = region))
graph
is.data.frame(homeless_people_per_state)
View(drunk_people_total_by_state)
View(drunk_people_per_state)
homeless_people_per_state %>% ggvis(~State, ~Count) %>% layer_points(fill = ~temp_name) %>% drunk_people_per_state %>% ggvis(~region, ~both_sexes_2012) %>% layer_lines()
homeless_people_per_state %>% ggvis(~region, ~Count) %>% layer_points(fill = ~temp_name) %>% drunk_people_per_state %>% ggvis(~region, ~both_sexes_2012) %>% layer_lines()
homeless_people_per_state %>% ggvis(~region, ~average) %>% layer_points(fill = ~temp_name) %>% drunk_people_per_state %>% ggvis(~region, ~average) %>% layer_lines()
homeless_people_per_state %>% ggvis(~region, ~average) %>% layer_points(fill = ~temp_name)
plott <- homeless_people_per_state %>% ggvis(~region, ~average) %>% layer_points(fill = ~temp_name) #%>% drunk_people_per_state %>% ggvis(~region, ~average) %>% layer_lines()
plott <- drunk_people_per_state %>% ggvis(~region, ~average)
plott
plott <- homeless_people_per_state %>% ggvis(~region, ~average) %>% layer_points(fill = ~temp_name) #%>% drunk_people_per_state %>% ggvis(~region, ~average) %>% layer_lines()
plott <- drunk_people_per_state %>% ggvis(~region, ~average) %>% layer_paths()
states <- map_data("state")
plott
#names(drunk_people_per_state) <- c("region", "average")
names(drunk_people_per_state) <- c("State", "average")
names(homeless_people_per_state) <- c("State", "Sum Total")
plott <- homeless_people_per_state %>% ggvis(~region, ~average) %>% layer_points(fill = ~temp_name) #%>% drunk_people_per_state %>% ggvis(~region, ~average) %>% layer_lines()
plott <- drunk_people_per_state %>% ggvis(~region, ~average) %>% layer_paths()
#names(drunk_people_per_state) <- c("region", "average")
names(drunk_people_per_state) <- c("State", "average")
names(homeless_people_per_state) <- c("State", "Sum Total")
plott <- homeless_people_per_state %>% ggvis(~State, ~Sum Total) %>% layer_points(fill = ~temp_name) #%>% drunk_people_per_state %>% ggvis(~region, ~average) %>% layer_lines()
plott <- homeless_people_per_state %>% ggvis(~State, ~"Sum Total") %>% layer_points(fill = ~temp_name) #%>% drunk_people_per_state %>% ggvis(~region, ~average) %>% layer_lines()
plott <- drunk_people_per_state %>% ggvis(~State, ~average) %>% layer_paths()
states <- map_data("state")
plott
#names(drunk_people_per_state) <- c("region", "average")
names(drunk_people_per_state) <- c("State", "average")
names(homeless_people_per_state) <- c("State", "Sum Total")
plott <- homeless_people_per_state %>% ggvis(~State, ~"Sum Total") %>% layer_points(fill = ~temp_name) #%>% drunk_people_per_state %>% ggvis(~region, ~average) %>% layer_lines()
plott
#names(drunk_people_per_state) <- c("region", "average")
names(drunk_people_per_state) <- c("State", "average")
names(homeless_people_per_state) <- c("State", "Count")
plott <- homeless_people_per_state %>% ggvis(~State, ~Count) %>% layer_points(fill = ~temp_name) #%>% drunk_people_per_state %>% ggvis(~region, ~average) %>% layer_lines()
plott <- drunk_people_per_state %>% ggvis(~State, ~average) %>% layer_paths()
plott
plott <- homeless_people_per_state %>% ggvis(~State, ~Count) %>% layer_points(fill = ~temp_name) #%>% drunk_people_per_state %>% ggvis(~region, ~average) %>% layer_lines()
plott
plott <- drunk_people_per_state %>% ggvis(~State, ~average) %>% layer_paths()
plott
plott <- ggplot (drunk_people_per_state, aes(x=State, y=average)) + geom_bar()
plott
plott <- ggplot (drunk_people_per_state, aes(x=State, y=average)) + geom_bar(stat = "identity")
plott
plott <- plot + ggplot(drunk_people_per_state, aes(x=State, y=Count)) +
geom_point(size=2, shape=23)
plott
plott
plott <- ggplot (drunk_people_per_state, aes(x=State, y=average)) + geom_bar(stat = "identity")
plott <- plot + ggplot(drunk_people_per_state, aes(x=State, y=Count)) +
geom_point(size=2, shape=23)
plott
plott <- ggplot (drunk_people_per_state, aes(x=State, y=average)) + geom_bar(stat = "identity")
plott <- plot + ggplot(drunk_people_per_state, aes(x=State, y=Count)) +
geom_point()
plott
plott <- ggplot (drunk_people_per_state, aes(x=State, y=average)) + geom_bar(stat = "identity") +
ggplot(drunk_people_per_state, aes(x=State, y=Count)) +
geom_point()
plott <- ggplot (drunk_people_per_state, aes(x=State, y=average)) + geom_bar(stat = "identity") +
geom_point(drunk_people_per_state, aes(x=State, y=Count))
names(homeless_people_per_state) <- c("State", "Count")
plott <- ggplot (drunk_people_per_state, aes(x=State, y=average), color = 'class') + geom_bar(stat = "identity") +
geom_point(drunk_people_per_state, aes(x=State, y=Count))
plott <- ggplot (drunk_people_per_state, aes(x=State, y=average), color = 'class') + geom_bar(stat = "identity")
plott
plott <- ggplot (drunk_people_per_state, aes(x=State, y=average), color = "class") + geom_bar(stat = "identity")
plott
drunk_and_homeless_people <- left_join(drunk_people_per_state, homeless_people_per_state)
View(drunk_and_homeless_people)
View(drunk_and_homeless_people)
drunk_and_homeless_people <- full_join(drunk_people_per_state, homeless_people_per_state)
View(drunk_and_homeless_people)
drunk_and_homeless_people <- full_join(drunk_people_per_state, homeless_people_per_state)
drunk_and_homeless_people <- combine(drunk_people_per_state, homeless_people_per_state)
drunk_and_homeless_people <- join(drunk_people_per_state, homeless_people_per_state)
state.abb
state
state.ab
state.area
state.center
state.abb
states <- map_data("state")
graph <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "#ffffff", color = "#ffffff", size = 0.15)
graph <- graph + geom_map(data = drunk_people_per_state, map = states, aes(fill = average, map_id = region))
graph
states <- map_data("state")
graph <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = State),
fill = "#ffffff", color = "#ffffff", size = 0.15)
graph <- graph + geom_map(data = drunk_people_per_state, map = states, aes(fill = average, map_id = region))
# Clean up data for homeless people in States
state_save_csv <- function(state_name) {
output_data <- paste("Data/Data_by_states/", state_name, ".csv", sep = "")
state_of_data <- filter(total_homeless, State == state_name)
final_output <- write.csv(state_of_data, output_data, row.names = FALSE)
return(final_output)
}
graph
plott <- ggplot (drunk_people_per_state, aes(x=State, y=average), color = "class") + geom_contour()
plott
plott <- ggplot (drunk_people_per_state, aes(x=State, y=average, z = homeless_people_per_state$Count), color = "class") + geom_contour()
states <- map_data("state")
plott
plott <- ggplot (drunk_people_per_state, aes(x=State, y=average, z = 0), color = "class") + geom_contour()
plott
names(drunk_people_per_state) <- c("region", "average")
states <- map_data("state")
graph <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "#ffffff", color = "#ffffff", size = 0.15)
graph <- graph + geom_map(data = drunk_people_per_state, map = states, aes(fill = average, map_id = region))
graph
names(drunk_people_per_state) <- c("State", "average")
names(homeless_people_per_state) <- c("State", "Count")
plott <- ggplot (drunk_people_per_state, aes(x=State, y=average), color = "class") + geom_bar()
plott
names(drunk_people_per_state) <- c("State", "average")
names(homeless_people_per_state) <- c("State", "Count")
plott <- ggplot (drunk_people_per_state, aes(x=State, y=average), color = "class") + geom_bar(stat = identity)
names(drunk_people_per_state) <- c("State", "average")
names(homeless_people_per_state) <- c("State", "Count")
plott <- ggplot (drunk_people_per_state, aes(x=State, y=average), color = "class") + geom_bar(stat = "identity")
plott
plott <- ggplot (drunk_people_per_state, aes(x=State, y=average), color = "class") + geom_bar(stat = "identity")
+ layer(mapping = NULL,data = homeless_people_per_state ,geom = "point", geom_params = list(),
stat = "identity", stat_params = list(),position = "identity" )
names(drunk_people_per_state) <- c("State", "average")
names(homeless_people_per_state) <- c("State", "Count")
plott <- ggplot (drunk_people_per_state, aes(x=State, y=average), color = "class") + geom_bar(stat = "identity")
+ layer(mapping = NULL,data = homeless_people_per_state ,geom = "point",
stat = "identity",position = "identity" )
drunk_people_per_state$state.abb
left_join(drunk_people_per_state,abb)
left_join(drunk_people_per_state,state.abb)
left_join(state.abb, drunk_people_per_state)
is.data.frame(state.avv)
is.data.frame(state.abb)
lapply(drunk_people_per_state, state.abb[grep(State, state.name)])
lapply(drunk_people_per_state, state.abb[grep(State, state.name)])
lapply(drunk_people_per_state, state.abb[grep(State, state.name)])
lapply(drunk_people_per_state, state.abb[grep(State, state.name)])
state.abb
#Setting up libraries required for this task
library(shiny)
library(dplyr)
library(data.table)
library(ggplot2)
library(R.utils)
library(ggvis)
setwd("~/Desktop/BF5/")
homeless_by_state <- data.table :: fread("data/Homelessness.csv", sep = ",", stringsAsFactors = FALSE)
total_homeless <- homeless_by_state %>% filter(Measures == "Total Homeless") %>% filter(Year == "1/1/2012")
write.csv(total_homeless, "data/total_homeless.csv", row.names = TRUE)
#Clean up data for Binge Drinking in States
drunkards_by_state <- data.table :: fread ("data/binge_drinking.csv", sep = ",", stringsAsFactors = FALSE)
total_drunkards <- drunkards_by_state %>% select(state, location, both_sexes_2012)
total_drunkards
state_drink_csv <- function(state_name) {
output_data <- paste("Data/Data_by_states/", state_name, "d.csv", sep = "")
state_of_data <- filter(total_drunkards, state == state_name)
final_output <- write.csv(state_of_data, output_data)
return(final_output)
}
lapply(total_drunkards$state,state_drink_csv)
homeless_by_state$Count <- as.numeric(gsub(",","",homeless_by_state$Count))
homeless_people_per_state <- homeless_by_state%>% filter(Year == "1/1/2012") %>%
select(State, Count) %>% filter(State != "GU" & State != "PR" & State != "VI") %>%
filter(Count != "NA") %>%  group_by(State) %>%
summarise(Count = sum(as.numeric(Count))) %>% mutate(State = tolower(State))
drunk_people_total_by_state <- data.table :: fread ("data/binge_drinking.csv", sep = ",", stringsAsFactors = FALSE)
drunk_people_per_state <- drunk_people_total_by_state %>% select(state, both_sexes_2012) %>%
group_by(state) %>% summarise(average = mean(both_sexes_2012)) %>%
filter(state != "National") %>% mutate(state = tolower(state))
#names(drunk_people_per_state) <- c("region", "average")
names(drunk_people_per_state) <- c("State", "average")
names(homeless_people_per_state) <- c("State", "Count")
lapply()
plott <- ggplot (drunk_people_per_state, aes(x=State, y=average), color = "class") + geom_bar(stat = "identity")
+ ggplot(homeless_people_per_state, aes(x=drunk_people_per_state$state.abb))
names(drunk_people_per_state) <- c("region", "average")
plott
names(drunk_people_per_state) <- c("region", "average")
states <- map_data("state")
graph <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "#ffffff", color = "#ffffff", size = 0.15)
graph <- graph + geom_map(data = drunk_people_per_state, map = states, aes(fill = average, map_id = region))
graph
names(homeless_people_per_state) <- c("region", "average")
states <- map_data("state")
graph_homeless <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "#ffffff", color = "#ffffff", size = 0.15)
graph_homeless <- graph_homeless + geom_map(data = drunk_people_per_state, map = states, aes(fill = average, map_id = region))
graph_homeless
graph_drunk
names(drunk_people_per_state) <- c("region", "average")
states <- map_data("state")
graph_drunk <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "#ffffff", color = "#ffffff", size = 0.15)
graph_drunk <- graph_drunk + geom_map(data = drunk_people_per_state, map = states, aes(fill = average, map_id = region))
names(homeless_people_per_state) <- c("region", "average")
states <- map_data("state")
graph_homeless <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "#ffffff", color = "#ffffff", size = 0.15)
graph_homeless <- graph_homeless + geom_map(data = drunk_people_per_state, map = states, aes(fill = average, map_id = region))
graph_drunk
graph_homeless
graph_drunk
graph_homeless
graph_drunk
graph_drunk
graph_homeless
graph
names(drunk_people_per_state) <- c("region", "average")
states <- map_data("state")
graph_drunk <- ggplot(states) + geom_map(data = states, map = states,
aes(x="", y = "", map_id = region),
fill = "#ffffff", color = "#ffffff", size = 0.15)
graph_drunk <- graph_drunk + geom_map(data = drunk_people_per_state, map = states, aes(fill = average, map_id = region))
graph_drunk
names(drunk_people_per_state) <- c("region", "average")
states <- map_data("state")
graph_drunk <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "#ffffff", color = "#ffffff", size = 0.15)
graph_drunk <- graph_drunk + geom_map(data = drunk_people_per_state, map = states, aes(fill = average, map_id = region))
graph_drurnk
graph_drunk
map_data("state")
names(drunk_people_per_state) <- c("region", "average")
states <- map_data("state")
graph_drunk <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "#ffffff", color = "#fffff", size = 0.15)
graph_drunk <- graph_drunk + geom_map(data = drunk_people_per_state, map = states, aes(fill = average, map_id = region))
graph_drunk
names(drunk_people_per_state) <- c("region", "average")
states <- map_data("state")
graph_drunk <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "#ffffff", color = "#ffffff", size = 0.15)
graph_drunk <- graph_drunk + geom_map(data = drunk_people_per_state, map = states, aes(fill = average, map_id = region))
# Clean up data for homeless people in States
state_save_csv <- function(state_name) {
output_data <- paste("Data/Data_by_states/", state_name, ".csv", sep = "")
state_of_data <- filter(total_homeless, State == state_name)
final_output <- write.csv(state_of_data, output_data, row.names = FALSE)
return(final_output)
}
graph_drunk
states <- map_data("state")
graph_drunk <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "black", color = "white", size = 0.15)
graph_drunk <- graph_drunk + geom_map(data = drunk_people_per_state, map = states, aes(fill = average, map_id = region))
graph_drunk
#Setting up libraries required for this task
library(shiny)
library(dplyr)
library(data.table)
library(ggplot2)
library(R.utils)
library(ggvis)
setwd("~/Desktop/BF5/")
homeless_by_state <- data.table :: fread("data/Homelessness.csv", sep = ",", stringsAsFactors = FALSE)
total_homeless <- homeless_by_state %>% filter(Measures == "Total Homeless") %>% filter(Year == "1/1/2012")
write.csv(total_homeless, "data/total_homeless.csv", row.names = TRUE)
#Clean up data for Binge Drinking in States
drunkards_by_state <- data.table :: fread ("data/binge_drinking.csv", sep = ",", stringsAsFactors = FALSE)
total_drunkards <- drunkards_by_state %>% select(state, location, both_sexes_2012)
total_drunkards
state_drink_csv <- function(state_name) {
output_data <- paste("Data/Data_by_states/", state_name, "d.csv", sep = "")
state_of_data <- filter(total_drunkards, state == state_name)
final_output <- write.csv(state_of_data, output_data)
return(final_output)
}
lapply(total_drunkards$state,state_drink_csv)
graph_drunk <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "black", color = "white", size = 0.15)
graph_drunk <- graph_drunk + geom_map(data = drunk_people_per_state, map = states, aes(fill = average, map_id = region))
# Clean up data for homeless people in States
state_save_csv <- function(state_name) {
output_data <- paste("Data/Data_by_states/", state_name, ".csv", sep = "")
state_of_data <- filter(total_homeless, State == state_name)
final_output <- write.csv(state_of_data, output_data, row.names = FALSE)
return(final_output)
}
lapply(total_homeless$State,state_save_csv)
#data_sets <- read.csv("data/data_by_states/ME.csv", stringsAsFactors = FALSE)
data_sets
data_sets_drunk <- read.csv("data/data_by_states/MainedrunkPeople.csv", stringsAsFactors = FALSE)
my_server <- function(input, output) {
output$states <- renderPlot ({
input_state <- input$state_select
data_sets <- read.csv(paste("Data/Data_by_states/", input_state, "d.csv", sep = ""), stringsAsFactors = FALSE)
#stata_drunk_data_select <- read.csv(paste("data/data_by_states/", input_state,"drunkPeople.csv", sep=""), stringsAsFactors = FALSE)
ggplot(
data_sets,
aes(x=location,y=both_sexes_2012) +
labs(xlab = input_state, ylab = "Number of Homeless Reported in the Year 2012")
)
#data_sets %>% ggvis(~Year, ~Count) %>% layer_points(fill = ~temp_name) #%>% data_sets_drunk %>% ggvis(~location, ~both_sexes_2012) %>% layer_lines()
})
}
graph_drunk
names(drunk_people_per_state) <- c("State", "Average")
states <- map_data("state")
graph_drunk <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "black", color = "white", size = 0.15)
graph_drunk <- graph_drunk + geom_map(data = drunk_people_per_state, map = states, aes(fill = average, map_id = State))
graph_drunk
names(drunk_people_per_state) <- c("State", "Average")
states <- map_data("state")
graph_drunk <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "black", color = "white", size = 0.15)
graph_drunk <- graph_drunk + geom_map(data = drunk_people_per_state, map = states, aes(fill = Average, map_id = State))
# Clean up data for homeless people in States
state_save_csv <- function(state_name) {
output_data <- paste("Data/Data_by_states/", state_name, ".csv", sep = "")
state_of_data <- filter(total_homeless, State == state_name)
final_output <- write.csv(state_of_data, output_data, row.names = FALSE)
return(final_output)
}
graph_drunk
names(drunk_people_per_state) <- c("State", "Average")
states <- map_data("state")
graph_drunk <- ggplot(states) + geom_map(data = states, map = states,
aes(x = long, y = lat, map_id = region),
fill = "grey", color = "white", size = 0.15)
graph_drunk <- graph_drunk + geom_map(data = drunk_people_per_state, map = states, aes(fill = Average, map_id = State))
graph_drunk
